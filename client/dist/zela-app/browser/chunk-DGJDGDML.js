import{$ as ke,A as r,B as l,C as v,D as m,E as u,F as A,G as _,H as W,I as g,J as V,K as h,L as we,M as Ce,N as Se,O as be,P as L,Q as c,R as z,S as w,T as j,U as H,V as N,W as _e,X as xe,Y as Ee,Z as k,_ as te,a as X,aa as T,b as Y,c as me,ca as oe,d as ue,e as ee,f as he,g as fe,h as ie,ha as ne,i as ge,j as y,k as d,ka as G,l as p,la as q,m as b,ma as $,n as E,na as O,p as x,q as U,r as a,s as M,t as C,u as S,v as P,w as ve,x as D,y as R,z as F}from"./chunk-SSQ3KYCD.js";var I=class n{constructor(i,e){this.http=i;this.router=e}apiUrl="http://localhost:3000/api";tokenKey="auth_token";userKey="user_data";isAuthenticatedSubject=new me(this.hasToken());currentUserSubject=new me(this.getUserFromStorage());login(i){return this.http.post(`${this.apiUrl}/auth/login`,i).pipe(fe(e=>{this.setToken(e.token),this.setUser(e.user),this.isAuthenticatedSubject.next(!0),this.currentUserSubject.next(e.user)}),he(e=>(this.clearAuthData(),ue(()=>e))))}register(i){return this.http.post(`${this.apiUrl}/auth/register`,i).pipe(fe(e=>{this.setToken(e.token),this.setUser(e.user),this.isAuthenticatedSubject.next(!0),this.currentUserSubject.next(e.user)}),he(e=>(this.clearAuthData(),ue(()=>e))))}logout(){this.clearAuthData(),this.isAuthenticatedSubject.next(!1),this.currentUserSubject.next(null),this.router.navigate(["/login"])}isAuthenticated(){return this.isAuthenticatedSubject.asObservable()}get isAuthenticatedValue(){return this.isAuthenticatedSubject.value}getCurrentUser(){return this.currentUserSubject.asObservable()}get currentUserValue(){return this.currentUserSubject.value}getToken(){return localStorage.getItem(this.tokenKey)}isTokenExpiring(){let i=this.getToken();if(!i)return!0;try{let t=JSON.parse(atob(i.split(".")[1])).exp*1e3,o=Date.now(),s=300*1e3;return t-o<s}catch{return!0}}updateUser(i){this.setUser(i),this.currentUserSubject.next(i)}setToken(i){localStorage.setItem(this.tokenKey,i)}setUser(i){localStorage.setItem(this.userKey,JSON.stringify(i))}hasToken(){return!!this.getToken()}getUserFromStorage(){let i=localStorage.getItem(this.userKey);return i?JSON.parse(i):null}clearAuthData(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.userKey)}static \u0275fac=function(e){return new(e||n)(ge(oe),ge(ne))};static \u0275prov=ie({token:n,factory:n.\u0275fac,providedIn:"root"})};var Z=class n{http=y(oe);authService=y(I);apiUrl="http://localhost:3000/api/reports";_reports=x([]);reports=Ee(()=>this._reports());constructor(){this.loadReports()}async loadReports(){try{let i=await ee(this.http.get(this.apiUrl));this._reports.set(i)}catch(i){console.error("Erro ao carregar reports:",i)}}async addReport(i){try{let e=await ee(this.http.post(this.apiUrl,i));return this._reports.update(t=>[e,...t]),e}catch(e){throw console.error("Erro ao adicionar report:",e),e}}async addSupport(i){try{await ee(this.http.patch(`${this.apiUrl}/${i}/support`,{})),this._reports.update(e=>e.map(t=>t._id===i?Y(X({},t),{supportCount:t.supportCount+1}):t))}catch(e){console.error("Erro ao apoiar report:",e)}}async patrocinar(i,e){let t=this.authService.currentUserValue;if(!t||t.balance<e.cost)return!1;try{let o=await ee(this.http.patch(`${this.apiUrl}/${i}/sponsor`,{option:e}));return o&&o.report?(this._reports.update(s=>s.map(f=>f._id===i?o.report:f)),this.authService.updateUser(Y(X({},t),{balance:o.balance})),!0):!1}catch(o){return console.error("Erro ao patrocinar report:",o),!1}}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ie({token:n,factory:n.\u0275fac,providedIn:"root"})};var De=["scrollContainer"];function Re(n,i){if(n&1&&(m(0,"div",9),A(1,"img",23),u()),n&2){let e=i.$implicit;a(),W("src",e,U)}}function Ae(n,i){if(n&1&&A(0,"div"),n&2){let e=i.$index,t=h(2);L("w-1.5 h-1.5 rounded-full transition-all "+(t.currentIndex()===e?"bg-white w-4":"bg-white/50"))}}function Ie(n,i){if(n&1){let e=_();m(0,"button",24),V("click",function(){d(e);let o=h();return p(o.scrollPrev())}),b(),m(1,"svg",18),A(2,"path",25),u()(),E(),m(3,"button",26),V("click",function(){d(e);let o=h();return p(o.scrollNext())}),b(),m(4,"svg",18),A(5,"path",27),u()(),E(),m(6,"div",28),D(7,Ae,1,2,"div",29,P),u()}if(n&2){let e,t=h();a(7),R((e=t.report())==null?null:e.images)}}var re=class n{report=te.required();support=k();sponsor=k();solve=k();scrollContainer;currentIndex=x(0);onScroll(i){let e=i.target,t=Math.round(e.scrollLeft/e.offsetWidth);this.currentIndex()!==t&&this.currentIndex.set(t)}scrollPrev(){this.scrollContainer.nativeElement.scrollLeft-=this.scrollContainer.nativeElement.offsetWidth}scrollNext(){this.scrollContainer.nativeElement.scrollLeft+=this.scrollContainer.nativeElement.offsetWidth}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-report-card"]],viewQuery:function(e,t){if(e&1&&we(De,5),e&2){let o;Ce(o=Se())&&(t.scrollContainer=o.first)}},inputs:{report:[1,"report"]},outputs:{support:"support",sponsor:"sponsor",solve:"solve"},decls:39,vars:7,consts:[["scrollContainer",""],[1,"bg-white","border","border-gray-100","rounded-[2.5rem]","p-6","shadow-sm","mb-6","hover:shadow-md","transition-shadow"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-[10px]","font-black","text-blue-500","bg-blue-50","px-3","py-1","rounded-full","uppercase","tracking-widest"],[1,"text-[10px]","font-bold","text-gray-400","uppercase","tracking-tighter"],[1,"text-lg","font-black","text-slate-800","uppercase","italic","mb-1"],[1,"text-xs","text-gray-500","mb-4","line-clamp-2","leading-relaxed"],[1,"relative","group","mb-4"],[1,"flex","gap-2","overflow-x-auto","pb-2","scrollbar-hide","snap-x","snap-mandatory","scroll-smooth",3,"scroll"],[1,"flex-shrink-0","w-full","aspect-video","bg-slate-100","rounded-3xl","overflow-hidden","shadow-inner","snap-center"],[1,"absolute","bottom-10","left-4","bg-white/80","backdrop-blur-md","px-3","py-1","rounded-full","text-[9px]","font-bold","flex","items-center","gap-1"],[1,"flex","gap-4","mb-6"],[1,"flex-1","bg-slate-50","rounded-2xl","p-3","text-center","border","border-slate-100"],[1,"text-[9px]","font-black","text-gray-400","uppercase","mb-1","tracking-widest"],[1,"text-sm","font-black","text-amber-600"],[1,"text-sm","font-black","text-blue-600"],[1,"flex","flex-col","gap-3"],[1,"w-full","py-4","rounded-2xl","bg-emerald-50","text-emerald-600","border","border-emerald-100","text-[10px]","font-black","uppercase","tracking-widest","active:scale-95","transition-all","hover:bg-emerald-100","flex","items-center","justify-center","gap-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"grid","grid-cols-2","gap-3"],[1,"py-4","rounded-2xl","bg-amber-50","text-[10px]","font-black","uppercase","text-amber-600","border","border-amber-100","active:scale-95","transition-transform","hover:bg-amber-100",3,"click"],[1,"py-4","rounded-2xl","bg-blue-50","text-[10px]","font-black","uppercase","text-blue-600","border","border-blue-100","active:scale-95","transition-transform","hover:bg-blue-100",3,"click"],[1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","left-2","top-1/2","-translate-y-1/2","w-8","h-8","bg-white/90","backdrop-blur","rounded-full","flex","items-center","justify-center","shadow-lg","text-slate-800","opacity-0","group-hover:opacity-100","transition-opacity",3,"click"],["stroke-width","3","d","M15 19l-7-7 7-7"],[1,"absolute","right-2","top-1/2","-translate-y-1/2","w-8","h-8","bg-white/90","backdrop-blur","rounded-full","flex","items-center","justify-center","shadow-lg","text-slate-800","opacity-0","group-hover:opacity-100","transition-opacity",3,"click"],["stroke-width","3","d","M9 5l7 7-7 7"],[1,"absolute","bottom-4","left-1/2","-translate-x-1/2","flex","gap-1.5","px-2","py-1","bg-black/20","backdrop-blur-md","rounded-full"],[3,"class"]],template:function(e,t){if(e&1){let o=_();m(0,"div",1)(1,"div",2)(2,"span",3),c(3),u(),m(4,"span",4),c(5,"H\xE1 2 horas"),u()(),m(6,"h3",5),c(7),u(),m(8,"p",6),c(9),u(),m(10,"div",7)(11,"div",8,0),V("scroll",function(f){return d(o),p(t.onScroll(f))}),D(13,Re,2,1,"div",9,P),u(),m(15,"div",10),c(16),u(),C(17,Ie,9,0),u(),m(18,"div",11)(19,"div",12)(20,"p",13),c(21,"Fundo atual"),u(),m(22,"p",14),c(23),u()(),m(24,"div",12)(25,"p",13),c(26,"Apoiadores"),u(),m(27,"p",15),c(28),u()()(),m(29,"div",16)(30,"button",17),V("click",function(){return d(o),p(t.solve.emit(t.report()._id))}),b(),m(31,"svg",18),A(32,"path",19),u(),c(33," Eu Resolvo! "),u(),E(),m(34,"div",20)(35,"button",21),V("click",function(){return d(o),p(t.sponsor.emit(t.report()._id))}),c(36," Patrocinar "),u(),m(37,"button",22),V("click",function(){return d(o),p(t.support.emit(t.report()._id))}),c(38," Apoiar Causa "),u()()()()}if(e&2){let o;a(3),w(" ",t.report().category," "),a(4),z(t.report().title),a(2),z(t.report().description),a(4),R(t.report().images),a(3),w(" \u{1F4CD} ",t.report().location," "),a(),S((o=t.report())!=null&&o.images&&t.report().images.length>1?17:-1),a(6),w("\u2B50 ",t.report().zelasAcumulados),a(5),w("\u{1F465} ",t.report().supportCount)}},dependencies:[T],encapsulation:2,changeDetection:0})};var Le=(n,i)=>i.id;function je(n,i){if(n&1){let e=_();m(0,"button",11),V("click",function(){let o=d(e).$implicit,s=h();return p(s.selectedOption.set(o))}),m(1,"div",12)(2,"div"),c(3),u(),m(4,"div")(5,"h4",13),c(6),u(),m(7,"p",14),c(8),u()()(),m(9,"div",15)(10,"span",16),c(11),u()()()}if(n&2){let e,t=i.$implicit,o=h();L("w-full flex items-center justify-between p-5 rounded-3xl border-2 transition-all "+(((e=o.selectedOption())==null?null:e.id)===t.id?"border-blue-600 bg-blue-50/50":"border-slate-100 hover:border-slate-200")),a(2),L("w-12 h-12 rounded-2xl flex items-center justify-center text-xl "+t.color),a(),w(" ",t.id==="BRONZE"?"\u{1F949}":t.id==="PRATA"?"\u{1F948}":"\u{1F947}"," "),a(3),z(t.label),a(2),z(t.boost),a(3),w("",t.cost," Z")}}var ae=class n{close=k();success=k();selectedOption=x(null);options=[{id:"BRONZE",label:"Bronze",cost:100,boost:"+24h Destaque",color:"bg-orange-100 text-orange-700"},{id:"PRATA",label:"Prata",cost:250,boost:"+72h Destaque",color:"bg-slate-100 text-slate-600"},{id:"OURO",label:"Ouro",cost:500,boost:"Destaque Vital\xEDcio",color:"bg-amber-100 text-amber-700"}];confirm(){this.selectedOption()&&this.success.emit(this.selectedOption())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-sponsor-modal"]],outputs:{close:"close",success:"success"},decls:15,vars:1,consts:[[1,"fixed","inset-0","z-[100]","flex","items-end","sm:items-center","justify-center","p-0","sm:p-4","bg-slate-900/60","backdrop-blur-sm"],[1,"bg-white","w-full","max-w-md","rounded-t-[3rem]","sm:rounded-[3rem]","p-8","shadow-2xl","animate-in","slide-in-from-bottom","duration-300"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-xl","font-black","text-slate-900","uppercase","italic"],[1,"p-2","bg-slate-100","rounded-full",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["d","M6 18L18 6M6 6l12 12"],[1,"text-xs","font-bold","text-slate-400","uppercase","tracking-widest","mb-6"],[1,"space-y-3","mb-8"],[3,"class"],[1,"w-full","py-5","bg-slate-900","text-white","font-black","rounded-2xl","uppercase","tracking-widest","shadow-xl","active:scale-95","transition-all","disabled:opacity-50",3,"click","disabled"],[3,"click"],[1,"flex","items-center","gap-4","text-left"],[1,"font-black","text-slate-800","uppercase","italic","text-sm"],[1,"text-[10px]","font-bold","text-slate-500","uppercase"],[1,"text-right"],[1,"block","font-black","text-slate-900","text-sm"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),c(4,"Impulsionar Alerta"),u(),m(5,"button",4),V("click",function(){return t.close.emit()}),b(),m(6,"svg",5),A(7,"path",6),u()()(),E(),m(8,"p",7),c(9,"Escolha o n\xEDvel de patroc\xEDnio para aumentar a visibilidade e prioridade desta ocorr\xEAncia."),u(),m(10,"div",8),D(11,je,12,8,"button",9,Le),u(),m(13,"button",10),V("click",function(){return t.confirm()}),c(14," Confirmar Patroc\xEDnio "),u()()()),e&2&&(a(11),R(t.options),a(2),W("disabled",!t.selectedOption()))},dependencies:[T],encapsulation:2,changeDetection:0})};function He(n,i){if(n&1&&(A(0,"img",3),m(1,"div")(2,"p",4),c(3," Cidad\xE3o Ativo "),u(),m(4,"h1",5),c(5),u()()),n&2){let e,t,o=h();W("src",(e=o.user())==null?null:e.avatar,U),a(5),z((t=o.user())==null?null:t.name)}}function Ne(n,i){n&1&&(m(0,"div",6),A(1,"div",7),u(),m(2,"div")(3,"p",4),c(4," Bem-vindo "),u(),m(5,"h1",5),c(6,"Visitante"),u()())}function Fe(n,i){if(n&1){let e=_();m(0,"div",8)(1,"span",9),c(2),u()(),m(3,"button",10),V("click",function(){d(e);let o=h();return p(o.authService.logout())}),b(),m(4,"svg",11),A(5,"path",12),u()()}if(n&2){let e,t=h();a(2),w("\u2B50 ",(e=t.user())==null?null:e.balance)}}function Ue(n,i){if(n&1){let e=_();m(0,"button",13),V("click",function(){d(e);let o=h();return p(o.loginClick.emit())}),c(1," Entrar "),u()}}var le=class n{authService=y(I);balance=te.required();user=te(null);loginClick=k();static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-header"]],inputs:{balance:[1,"balance"],user:[1,"user"]},outputs:{loginClick:"loginClick"},decls:6,vars:2,consts:[[1,"bg-white","border-b","border-gray-100","px-6","py-4","flex","items-center","justify-between","sticky","top-0","z-30"],[1,"flex","items-center","gap-3"],[1,"px-4","py-2","bg-slate-900","text-white","rounded-xl","text-xs","font-black","uppercase","tracking-widest","hover:bg-blue-600","transition-colors","shadow-lg","active:scale-95"],[1,"w-10","h-10","rounded-full","bg-slate-100",3,"src"],[1,"text-[8px]","font-black","text-gray-400","uppercase","tracking-widest","leading-none"],[1,"text-xs","font-black","text-slate-900","uppercase","italic"],[1,"w-10","h-10","rounded-xl","bg-slate-100","flex","items-center","justify-center"],[1,"w-6","h-6","bg-slate-300","rounded-full"],[1,"bg-amber-50","px-3","py-2","rounded-xl","border","border-amber-100"],[1,"text-xs","font-black","text-amber-700"],[1,"p-3","bg-slate-100","rounded-xl","hover:bg-red-50","text-slate-500","hover:text-red-500","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7"],[1,"px-4","py-2","bg-slate-900","text-white","rounded-xl","text-xs","font-black","uppercase","tracking-widest","hover:bg-blue-600","transition-colors","shadow-lg","active:scale-95",3,"click"]],template:function(e,t){e&1&&(m(0,"header",0)(1,"div",1),C(2,He,6,2)(3,Ne,7,0),u(),C(4,Fe,6,1)(5,Ue,2,0,"button",2),u()),e&2&&(a(2),S(t.user()?2:3),a(2),S(t.user()?4:5))},dependencies:[T],encapsulation:2,changeDetection:0})};function ze(n,i){if(n&1&&(r(0,"div",6),c(1),l()),n&2){let e=h();a(),w(" ",e.errorMessage()," ")}}function Oe(n,i){if(n&1){let e=_();r(0,"div",8)(1,"div",9),b(),r(2,"svg",10),v(3,"path",19),l()(),E(),r(4,"input",20),N("ngModelChange",function(o){d(e);let s=h();return H(s.form.name,o)||(s.form.name=o),p(o)}),l()()}if(n&2){let e=h();a(4),j("ngModel",e.form.name)}}var se=class n{zelaService=y(Z);authService=y(I);router=y(ne);isLogin=x(!0);errorMessage=x("");form={name:"",email:"",password:""};success=k();handleSubmit(){this.errorMessage.set(""),this.isLogin()?this.authService.login({email:this.form.email,password:this.form.password}).subscribe({next:()=>this.success.emit(),error:i=>{console.error("Login error:",i);let e=i.error?.error||"Falha no login. Verifique as suas credenciais.";this.errorMessage.set(e)}}):this.authService.register(this.form).subscribe({next:()=>this.success.emit(),error:i=>{console.error("Register error:",i);let e=i.error?.error||"Falha no registo. Tente novamente.";this.errorMessage.set(e)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-auth"]],outputs:{success:"success"},decls:29,vars:9,consts:[[1,"flex","flex-col","items-center","justify-center","bg-white","p-6"],[1,"w-full"],[1,"flex","flex-col","items-center","mb-8"],[1,"w-20","h-20","bg-gradient-to-tr","from-blue-600","to-blue-400","rounded-[2rem]","flex","items-center","justify-center","text-white","font-black","text-4xl","shadow-xl","shadow-blue-200","mb-6","italic","transform","hover:scale-105","transition-transform","duration-300"],[1,"text-2xl","font-black","text-slate-800","tracking-tight","italic","uppercase","text-center","mb-1"],[1,"text-slate-400","text-xs","font-medium","text-center","max-w-[200px]","leading-relaxed"],[1,"mb-6","p-4","bg-red-50","border","border-red-100","rounded-2xl","text-red-500","text-xs","font-bold","text-center","animate-pulse"],[1,"space-y-4"],[1,"relative","group"],[1,"absolute","inset-y-0","left-0","pl-4","flex","items-center","pointer-events-none"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-300","group-focus-within:text-blue-500","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"],["type","email","placeholder","Seu E-mail",1,"w-full","py-4","pl-12","pr-4","bg-slate-50","border-2","border-transparent","focus:border-blue-500","focus:bg-white","rounded-2xl","font-semibold","outline-none","transition-all","text-sm","placeholder:text-slate-300","text-slate-700",3,"ngModelChange","ngModel"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],["type","password","placeholder","Sua Senha",1,"w-full","py-4","pl-12","pr-4","bg-slate-50","border-2","border-transparent","focus:border-blue-500","focus:bg-white","rounded-2xl","font-semibold","outline-none","transition-all","text-sm","placeholder:text-slate-300","text-slate-700",3,"ngModelChange","ngModel"],[1,"w-full","py-5","bg-gradient-to-r","from-blue-600","to-blue-500","hover:from-blue-500","hover:to-blue-400","text-white","font-bold","rounded-2xl","uppercase","tracking-widest","shadow-lg","shadow-blue-200","active:scale-[0.98]","transition-all","mt-6","text-xs",3,"click"],[1,"mt-8","text-center","pt-6","border-t","border-slate-50"],[1,"text-xs","font-bold","text-slate-400","hover:text-blue-600","transition-colors","group",3,"click"],[1,"block","text-blue-600","group-hover:underline","mt-1","uppercase","tracking-wider","text-[10px]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["type","text","placeholder","Seu Nome Completo",1,"w-full","py-4","pl-12","pr-4","bg-slate-50","border-2","border-transparent","focus:border-blue-500","focus:bg-white","rounded-2xl","font-semibold","outline-none","transition-all","text-sm","placeholder:text-slate-300","text-slate-700",3,"ngModelChange","ngModel"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c(4," Z "),l(),r(5,"h1",4),c(6),l(),r(7,"p",5),c(8),l()(),C(9,ze,2,1,"div",6),r(10,"div",7),C(11,Oe,5,1,"div",8),r(12,"div",8)(13,"div",9),b(),r(14,"svg",10),v(15,"path",11),l()(),E(),r(16,"input",12),N("ngModelChange",function(s){return H(t.form.email,s)||(t.form.email=s),s}),l()(),r(17,"div",8)(18,"div",9),b(),r(19,"svg",10),v(20,"path",13),l()(),E(),r(21,"input",14),N("ngModelChange",function(s){return H(t.form.password,s)||(t.form.password=s),s}),l()(),r(22,"button",15),g("click",function(){return t.handleSubmit()}),c(23),l()(),r(24,"div",16)(25,"button",17),g("click",function(){return t.isLogin.set(!t.isLogin())}),c(26),r(27,"span",18),c(28),l()()()()()),e&2&&(a(6),w(" ",t.isLogin()?"Bem-vindo de volta!":"Junte-se ao Zela"," "),a(2),w(" ",t.isLogin()?"Entre para continuar a cuidar da sua cidade.":"Crie sua conta e comece a fazer a diferen\xE7a hoje."," "),a(),S(t.errorMessage()?9:-1),a(2),S(t.isLogin()?-1:11),a(5),j("ngModel",t.form.email),a(5),j("ngModel",t.form.password),a(2),w(" ",t.isLogin()?"Entrar Agora":"Criar Minha Conta"," "),a(3),w(" ",t.isLogin()?"N\xE3o tem uma conta?":"J\xE1 possui cadastro?"," "),a(2),w(" ",t.isLogin()?"Criar Nova Conta":"Fazer Login"," "))},dependencies:[O,G,q,$,T],encapsulation:2,changeDetection:0})};function Be(n,i){n&1&&(r(0,"span",11),c(1,"Toque para adicionar"),l())}function Pe(n,i){if(n&1){let e=_();r(0,"button",27),g("click",function(){d(e);let o=h();return p(o.triggerFileInput())}),b(),r(1,"svg",28),v(2,"path",29),l()()}}function We(n,i){if(n&1){let e=_();r(0,"div",14),v(1,"img",30),r(2,"button",31),g("click",function(){let o=d(e).$index,s=h();return p(s.removePhoto(o))}),b(),r(3,"svg",32),v(4,"path",33),l()()()}if(n&2){let e=i.$implicit;a(),F("src",e,U)}}function Ge(n,i){if(n&1){let e=_();r(0,"button",34),g("click",function(){let o=d(e).$implicit,s=h();return p(s.reportData.category=o)}),c(1),l()}if(n&2){let e=i.$implicit,t=h();L("py-3 rounded-xl font-black text-[10px] uppercase transition-all "+(t.reportData.category===e?"bg-blue-600 text-white":"bg-slate-100 text-slate-500")),a(),w(" ",e," ")}}var ce=class n{authService=y(I);close=k();success=k();categories=["LIMPEZA","INFRA","SEGURAN\xC7A","OUTROS"];images=x([]);reportData={title:"",category:"LIMPEZA",location:"",description:"",authorId:""};triggerFileInput(){document.querySelector('input[type="file"]')?.click()}async handleFile(i){let e=i.target.files[0];if(e&&e&&this.images().length<5){let t=new FileReader;t.onload=o=>{let s=new Image;s.src=o.target.result,s.onload=()=>{let f=document.createElement("canvas"),J=800,Q=s.width,pe=s.height;Q>J&&(pe*=J/Q,Q=J),f.width=Q,f.height=pe,f.getContext("2d")?.drawImage(s,0,0,Q,pe);let Ve=f.toDataURL("image/jpeg",.6);this.images.update(Te=>[...Te,Ve])}},t.readAsDataURL(e)}}removePhoto(i){this.images.update(e=>e.filter((t,o)=>o!==i))}async submit(){let i=this.authService.currentUserValue;this.reportData.authorId=i.id,this.success.emit(Y(X({},this.reportData),{images:this.images()})),console.warn(this.images().length),this.close.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-create-report"]],outputs:{close:"close",success:"success"},decls:45,vars:7,consts:[["fileInput",""],[1,"fixed","inset-0","z-[100]","flex","items-end","sm:items-center","justify-center","p-0","sm:p-4","bg-slate-900/60","backdrop-blur-sm"],[1,"bg-white","w-full","max-w-md","rounded-t-[3rem]","sm:rounded-[3rem]","p-8","shadow-2xl","animate-in","slide-in-from-bottom","duration-300","max-h-[90vh]","overflow-y-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-xl","font-black","text-slate-900","uppercase","italic","leading-none"],[1,"p-2","bg-slate-100","rounded-full","text-slate-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["d","M6 18L18 6M6 6l12 12"],[1,"space-y-6","mb-8"],[1,"flex","justify-between","items-center","mb-2"],[1,"text-[10px]","font-black","text-slate-400","uppercase","tracking-widest"],[1,"text-[9px]","font-bold","text-blue-500","uppercase"],[1,"flex","gap-2","overflow-x-auto","pb-2","scrollbar-hide"],[1,"flex-shrink-0","w-20","h-20","border-2","border-dashed","border-slate-200","rounded-2xl","flex","items-center","justify-center","text-slate-300","hover:border-blue-300","hover:text-blue-300","transition-all"],[1,"relative","flex-shrink-0","w-20","h-20","group"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"text-[10px]","font-black","text-slate-400","uppercase","tracking-widest","mb-2","block"],["type","text","placeholder","Ex: Vazamento de \xE1gua",1,"w-full","p-4","bg-slate-50","border-2","border-slate-100","rounded-2xl","font-bold","outline-none","focus:border-blue-200","transition-colors","text-sm",3,"ngModelChange","ngModel"],["rows","3","placeholder","Descreva a ocorr\xEAncia com mais detalhes, como situa\xE7\xE3o, urg\xEAncia, impactos...",1,"w-full","p-4","bg-slate-50","border-2","border-slate-100","rounded-2xl","font-medium","outline-none","focus:border-blue-200","transition-colors","text-sm","resize-none",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-2"],[3,"class"],[1,"relative"],["type","text","placeholder","Rua, N\xFAmero, Bairro",1,"w-full","p-4","bg-slate-50","border-2","border-slate-100","rounded-2xl","font-bold","outline-none","focus:border-blue-200","transition-colors","text-sm","pr-12",3,"ngModelChange","ngModel"],[1,"absolute","right-4","top-1/2","-translate-y-1/2","text-slate-300"],["d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"w-full","py-5","bg-blue-600","text-white","font-black","rounded-2xl","uppercase","tracking-widest","shadow-xl","shadow-blue-200","active:scale-95","transition-all","disabled:opacity-50",3,"click","disabled"],[1,"flex-shrink-0","w-20","h-20","border-2","border-dashed","border-slate-200","rounded-2xl","flex","items-center","justify-center","text-slate-300","hover:border-blue-300","hover:text-blue-300","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8"],["stroke-width","2.5","d","M12 4v16m8-8H4"],[1,"w-full","h-full","object-cover","rounded-2xl","border","border-slate-100",3,"src"],[1,"absolute","-top-1","-right-1","bg-red-500","text-white","rounded-full","p-1","shadow-md","hover:scale-110","transition-transform",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-width","3","d","M6 18L18 6M6 6l12 12"],[3,"click"]],template:function(e,t){if(e&1){let o=_();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),c(4,"Novo Alerta"),l(),r(5,"button",5),g("click",function(){return d(o),p(t.close.emit())}),b(),r(6,"svg",6),v(7,"path",7),l()()(),E(),r(8,"div",8)(9,"div")(10,"div",9)(11,"label",10),c(12),l(),C(13,Be,2,0,"span",11),l(),r(14,"div",12),C(15,Pe,3,0,"button",13),D(16,We,5,1,"div",14,P),l(),r(18,"input",15,0),g("change",function(f){return d(o),p(t.handleFile(f))}),l()(),r(20,"div")(21,"label",16),c(22,"T\xEDtulo da Ocorr\xEAncia"),l(),r(23,"input",17),N("ngModelChange",function(f){return d(o),H(t.reportData.title,f)||(t.reportData.title=f),p(f)}),l()(),r(24,"div")(25,"label",16),c(26,"Descri\xE7\xE3o Detalhada"),l(),r(27,"textarea",18),N("ngModelChange",function(f){return d(o),H(t.reportData.description,f)||(t.reportData.description=f),p(f)}),l()(),r(28,"div")(29,"label",16),c(30,"Categoria"),l(),r(31,"div",19),D(32,Ge,2,3,"button",20,ve),l()(),r(34,"div")(35,"label",16),c(36,"Localiza\xE7\xE3o"),l(),r(37,"div",21)(38,"input",22),N("ngModelChange",function(f){return d(o),H(t.reportData.location,f)||(t.reportData.location=f),p(f)}),l(),r(39,"div",23),b(),r(40,"svg",6),v(41,"path",24)(42,"path",25),l()()()()(),E(),r(43,"button",26),g("click",function(){return d(o),p(t.submit())}),c(44," Publicar Alerta "),l()()()}e&2&&(a(12),w("Evid\xEAncias (",t.images().length,"/5)"),a(),S(t.images().length<5?13:-1),a(2),S(t.images().length<5?15:-1),a(),R(t.images()),a(7),j("ngModel",t.reportData.title),a(4),j("ngModel",t.reportData.description),a(5),R(t.categories),a(6),j("ngModel",t.reportData.location),a(5),F("disabled",!t.reportData.title||!t.reportData.location||!t.reportData.description))},dependencies:[O,G,q,$,T],encapsulation:2,changeDetection:0})};function qe(n,i){if(n&1){let e=_();r(0,"div",19),g("click",function(){d(e),h();let o=be(21);return p(o.click())}),b(),r(1,"svg",20),v(2,"path",21),l()()}}function $e(n,i){if(n&1){let e=_();r(0,"div",15),v(1,"img",22),r(2,"button",23),g("click",function(){let o=d(e).$index,s=h();return p(s.removeImage(o))}),b(),r(3,"svg",24),v(4,"path",25),l()()()}if(n&2){let e=i.$implicit;a(),F("src",e,U)}}var de=class n{close=k();success=k();plan=x("");images=x([]);previews=x([]);onFileSelected(i){let e=i.target;if(e.files&&e.files.length>0){let t=Array.from(e.files);this.images.update(o=>[...o,...t]),t.forEach(o=>{let s=new FileReader;s.onload=f=>{this.previews.update(J=>[...J,f.target?.result])},s.readAsDataURL(o)})}}removeImage(i){this.images.update(e=>e.filter((t,o)=>o!==i)),this.previews.update(e=>e.filter((t,o)=>o!==i))}submit(){this.plan()&&this.success.emit({plan:this.plan(),images:this.images()})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-solve-modal"]],outputs:{close:"close",success:"success"},decls:31,vars:3,consts:[["fileInput",""],[1,"fixed","inset-0","bg-slate-900/60","backdrop-blur-sm","z-[60]","flex","items-center","justify-center","p-6","animate-in","fade-in","zoom-in","duration-200"],[1,"bg-white","rounded-[2.5rem]","p-8","max-w-md","w-full","shadow-2xl","relative","overflow-hidden"],[1,"absolute","top-0","right-0","w-32","h-32","bg-emerald-50","rounded-bl-[100%]","-z-0"],[1,"relative","z-10"],[1,"w-16","h-16","bg-emerald-100","rounded-full","flex","items-center","justify-center","mb-6","text-3xl","shadow-inner"],[1,"text-2xl","font-black","text-slate-800","uppercase","italic","mb-1"],[1,"text-xs","text-gray-500","mb-6","font-medium"],[1,"space-y-4"],[1,"text-[10px]","font-black","text-slate-400","uppercase","tracking-widest","mb-2","block"],["rows","3","placeholder","Descreva brevemente o que vai fazer...",1,"w-full","p-4","bg-slate-50","border-2","border-slate-100","rounded-2xl","font-medium","text-sm","focus:border-emerald-500","focus:bg-white","outline-none","transition-all","resize-none","text-slate-700","placeholder:text-slate-300",3,"ngModelChange","ngModel"],[1,"text-emerald-500","ml-1","cursor-pointer","hover:underline",3,"click"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],[1,"flex","gap-2","overflow-x-auto","pb-2","scrollbar-hide"],[1,"w-20","h-20","rounded-2xl","border-2","border-dashed","border-slate-200","flex","items-center","justify-center","text-slate-300","cursor-pointer","hover:border-emerald-400","hover:text-emerald-400","transition-colors","shrink-0"],[1,"relative","w-20","h-20","rounded-2xl","overflow-hidden","shadow-sm","shrink-0","group"],[1,"flex","flex-col","gap-3","mt-6"],[1,"w-full","py-4","bg-emerald-50","disabled:bg-slate-50","disabled:text-slate-300","disabled:border-slate-100","text-emerald-600","border","border-emerald-100","font-black","rounded-2xl","uppercase","text-xs","tracking-widest","active:scale-95","transition-all","hover:bg-emerald-100",3,"click","disabled"],[1,"w-full","py-4","bg-transparent","text-slate-400","font-bold","rounded-2xl","uppercase","text-[10px]","tracking-widest","hover:text-slate-600","transition-colors",3,"click"],[1,"w-20","h-20","rounded-2xl","border-2","border-dashed","border-slate-200","flex","items-center","justify-center","text-slate-300","cursor-pointer","hover:border-emerald-400","hover:text-emerald-400","transition-colors","shrink-0",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","top-1","right-1","bg-red-500/80","text-white","rounded-full","p-1","opacity-0","group-hover:opacity-100","transition-opacity",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"]],template:function(e,t){if(e&1){let o=_();r(0,"div",1)(1,"div",2),v(2,"div",3),r(3,"div",4)(4,"div",5),c(5," \u{1F91D} "),l(),r(6,"h3",6),c(7,"Aceitar Miss\xE3o"),l(),r(8,"p",7),c(9,"Como voc\xEA pretende resolver este problema?"),l(),r(10,"div",8)(11,"div")(12,"label",9),c(13,"Seu Plano de A\xE7\xE3o"),l(),r(14,"textarea",10),N("ngModelChange",function(f){return d(o),H(t.plan,f)||(t.plan=f),p(f)}),l()(),r(15,"div")(16,"label",9),c(17," Fotos (Opcional) "),r(18,"span",11),g("click",function(){d(o);let f=be(21);return p(f.click())}),c(19,"+ Adicionar"),l()(),r(20,"input",12,0),g("change",function(f){return d(o),p(t.onFileSelected(f))}),l(),r(22,"div",13),C(23,qe,3,0,"div",14),D(24,$e,5,1,"div",15,P),l()(),r(26,"div",16)(27,"button",17),g("click",function(){return d(o),p(t.submit())}),c(28," Confirmar Miss\xE3o "),l(),r(29,"button",18),g("click",function(){return d(o),p(t.close.emit())}),c(30," Cancelar "),l()()()()()()}e&2&&(a(14),j("ngModel",t.plan),a(9),S(t.previews().length===0?23:-1),a(),R(t.previews()),a(3),F("disabled",!t.plan()))},dependencies:[T,O,G,q,$],encapsulation:2})};var Ze=(n,i)=>i._id;function Ke(n,i){if(n&1){let e=_();r(0,"app-report-card",16),g("support",function(){let o=d(e).$implicit,s=h();return p(s.handleSupport(o._id))})("sponsor",function(){let o=d(e).$implicit,s=h();return p(s.openSponsor(o._id))})("solve",function(){let o=d(e).$implicit,s=h();return p(s.handleSolve(o._id))}),l()}if(n&2){let e=i.$implicit;F("report",e)}}function Je(n,i){if(n&1){let e=_();r(0,"app-create-report",17),g("close",function(){d(e);let o=h();return p(o.showReportModal.set(!1))})("success",function(o){d(e);let s=h();return p(s.handleReportSuccess(o))}),l()}}function Qe(n,i){if(n&1){let e=_();r(0,"app-sponsor-modal",17),g("close",function(){d(e);let o=h();return p(o.showSponsorModal.set(!1))})("success",function(o){d(e);let s=h();return p(s.handleSponsorSuccess(o))}),l()}}function Xe(n,i){if(n&1){let e=_();r(0,"app-solve-modal",17),g("close",function(){d(e);let o=h();return p(o.showSolveModal.set(!1))})("success",function(o){d(e);let s=h();return p(s.confirmSolve(o))}),l()}}function Ye(n,i){if(n&1){let e=_();r(0,"div",15)(1,"div",18)(2,"button",19),g("click",function(){d(e);let o=h();return p(o.showAuthModal.set(!1))}),b(),r(3,"svg",10),v(4,"path",20),l()(),E(),r(5,"div",21)(6,"app-auth",22),g("success",function(){d(e);let o=h();return p(o.handleAuthSuccess())}),l()()()()}}var Me=class n{zelaService=y(Z);authService=y(I);loginEmail="";activeTab=x("home");showReportModal=x(!1);showSponsorModal=x(!1);showAuthModal=x(!1);showSolveModal=x(!1);activeReportId=x(null);activeSolveReportId=x(null);requireAuth(i){this.authService.isAuthenticatedValue?i():this.showAuthModal.set(!0)}handleReportSuccess(i){this.zelaService.addReport(i),this.showReportModal.set(!1)}openSponsor(i){this.requireAuth(()=>{this.activeReportId.set(i),this.showSponsorModal.set(!0)})}async handleSponsorSuccess(i){let e=this.activeReportId();e&&await this.zelaService.patrocinar(e,i)&&(this.showSponsorModal.set(!1),this.activeReportId.set(null))}handleSupport(i){this.requireAuth(()=>{this.zelaService.addSupport(i)})}openCreateReport(){this.requireAuth(()=>{this.showReportModal.set(!0)})}handleAuthSuccess(){this.showAuthModal.set(!1)}handleSolve(i){this.requireAuth(()=>{this.activeSolveReportId.set(i),this.showSolveModal.set(!0)})}confirmSolve(i){console.log("Resolving report:",this.activeSolveReportId(),i),this.showSolveModal.set(!1),this.activeSolveReportId.set(null),alert("Miss\xE3o aceite! Obrigado por ajudar a comunidade.")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-root"]],decls:26,vars:14,consts:[[1,"min-h-screen","bg-slate-50","pb-32"],[3,"loginClick","user","balance"],[1,"p-6","max-w-md","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-lg","font-black","text-slate-900","uppercase","italic"],[1,"flex","gap-1"],[1,"w-2","h-2","rounded-full","bg-blue-600","animate-pulse"],[3,"report"],[1,"fixed","bottom-0","left-0","right-0","bg-white/80","backdrop-blur-xl","border-t","border-slate-100","px-8","py-4","flex","items-center","justify-between","z-50"],[3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-width","2.5","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"w-14","h-14","bg-blue-600","text-white","rounded-2xl","flex","items-center","justify-center","shadow-xl","shadow-blue-200","-mt-10","border-4","border-white","active:scale-90","transition-transform",3,"click"],["stroke-width","3","d","M12 4v16m8-8H4"],["stroke-width","2.5","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"fixed","inset-0","bg-slate-900/40","backdrop-blur-sm","z-[60]","flex","items-center","justify-center","p-6","animate-in","fade-in","zoom-in","duration-200"],[3,"support","sponsor","solve","report"],[3,"close","success"],[1,"relative","w-full","max-w-sm"],[1,"absolute","-top-4","-right-4","z-10","bg-white","rounded-full","p-2","shadow-lg","text-slate-400","hover:text-red-500","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"bg-white","rounded-[3rem]","overflow-hidden","shadow-2xl"],[3,"success"]],template:function(e,t){if(e&1&&(r(0,"div",0)(1,"app-header",1),_e(2,"async"),_e(3,"async"),g("loginClick",function(){return t.showAuthModal.set(!0)}),l(),r(4,"main",2)(5,"div",3)(6,"h2",4),c(7,"Ocorr\xEAncias Ativas"),l(),r(8,"div",5),v(9,"div",6),l()(),D(10,Ke,1,1,"app-report-card",7,Ze),l(),r(12,"nav",8)(13,"button",9),g("click",function(){return t.activeTab.set("home")}),b(),r(14,"svg",10),v(15,"path",11),l()(),E(),r(16,"button",12),g("click",function(){return t.openCreateReport()}),b(),r(17,"svg",10),v(18,"path",13),l()(),E(),r(19,"button",9),g("click",function(){return t.activeTab.set("profile")}),b(),r(20,"svg",10),v(21,"path",14),l()()()(),C(22,Je,1,0,"app-create-report"),C(23,Qe,1,0,"app-sponsor-modal"),C(24,Xe,1,0,"app-solve-modal"),C(25,Ye,7,0,"div",15)),e&2){let o;a(),F("user",xe(2,10,t.authService.getCurrentUser()))("balance",((o=xe(3,12,t.authService.getCurrentUser()))==null?null:o.balance)||0),a(9),R(t.zelaService.reports()),a(3),L("p-2 transition-colors "+(t.activeTab()==="home"?"text-blue-600":"text-slate-300")),a(6),L("p-2 transition-colors "+(t.activeTab()==="profile"?"text-blue-600":"text-slate-300")),a(3),S(t.showReportModal()?22:-1),a(),S(t.showSponsorModal()?23:-1),a(),S(t.showSolveModal()?24:-1),a(),S(t.showAuthModal()?25:-1)}},dependencies:[T,O,le,re,ae,ce,se,de,ke],encapsulation:2,changeDetection:0})};export{Me as Home};
