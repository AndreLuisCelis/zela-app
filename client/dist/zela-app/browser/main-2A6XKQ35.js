import{C as d,a as i,aa as m,b as a,ba as h,da as c,ea as g,fa as f,ga as M,ia as b,ja as v,na as A,o as p,p as s,s as u}from"./chunk-SSQ3KYCD.js";var I=(r,e)=>{let o=localStorage.getItem("auth_token");if(o){let t=r.clone({setHeaders:{Authorization:`Bearer ${o}`}});return e(t)}return e(r)};var R=[{loadComponent:()=>import("./chunk-DGJDGDML.js").then(r=>r.Home),path:"home"},{loadComponent:()=>import("./chunk-DGJDGDML.js").then(r=>r.Home),path:""}];var C={providers:[p(),b(R),c(f(),g([I]))]};var l=class r{view=s("list");authMode=s("login");isLoggedIn=s(!1);userZelas=s(500);userName=s("Jo\xE3o Diniz");modalMessage=s(null);modalIcon=s("\u2B50");uploadedPhotos=s([]);selectedReportForSponsor=s(null);sponsorAmount=s(50);customSponsorValue=null;sponsorOptions=[50,100,200];authForm={name:"",email:"",password:""};reports=s([{id:"1",title:"Lixo na Pra\xE7a Central",description:"Ac\xFAmulo de entulho e lixo dom\xE9stico perto do monumento principal.",category:"LIMPEZA",location:"Pra\xE7a das Flores, Centro",status:"pendente",zelasAcumulados:120,apoios:45,photos:["https://images.unsplash.com/photo-1611284446314-60a58ac0deb9?q=80&w=600&auto=format&fit=crop","https://images.unsplash.com/photo-1530587191325-3db32d826c18?q=80&w=600&auto=format&fit=crop"],createdAt:new Date().toISOString(),userId:"user-1"}]);newReport={title:"",description:"",category:"INFRAESTRUTURA",location:""};scrollCarousel(e,o){let t=e.clientWidth;e.scrollBy({left:t*o,behavior:"smooth"})}toggleAuthMode(){this.authMode.update(e=>e==="login"?"signup":"login")}handleAuthSubmit(e){e.preventDefault(),this.isLoggedIn.set(!0),this.authMode()==="signup"&&this.authForm.name&&this.userName.set(this.authForm.name),this.view.set("list"),this.modalIcon.set("\u2728"),this.modalMessage.set(this.authMode()==="login"?"Bom regresso ao Zela!":"Conta criada com sucesso! Recebeu 500 Zelas de boas-vindas.")}logout(){this.isLoggedIn.set(!1),this.view.set("list"),this.authMode.set("login")}requireAuth(e){if(!this.isLoggedIn()){this.view.set("auth");return}e()}onFileSelected(e){let o=e.target.files[0];if(o&&this.uploadedPhotos().length<5){let t=new FileReader;t.onload=n=>{this.uploadedPhotos.update(S=>[...S,n.target.result])},t.readAsDataURL(o)}}removePhoto(e){this.uploadedPhotos.update(o=>o.filter((t,n)=>n!==e))}handleApoiar(e){this.requireAuth(()=>{this.reports.update(o=>o.map(t=>t.id===e?a(i({},t),{apoios:t.apoios+1}):t))})}openSponsorModal(e){this.requireAuth(()=>{this.selectedReportForSponsor.set(e),this.sponsorAmount.set(50),this.customSponsorValue=null})}onCustomSponsorInput(){this.customSponsorValue!==null&&this.sponsorAmount.set(this.customSponsorValue)}handleSponsor(e){if(this.userZelas()<e){this.modalIcon.set("\u274C"),this.modalMessage.set("Saldo de Zelas insuficiente.");return}let o=this.selectedReportForSponsor();o&&e>0&&(this.userZelas.update(t=>t-e),this.reports.update(t=>t.map(n=>n.id===o.id?a(i({},n),{zelasAcumulados:n.zelasAcumulados+e}):n)),this.selectedReportForSponsor.set(null),this.modalIcon.set("\u{1F680}"),this.modalMessage.set(`Obrigado! Investiste \u2B50 ${e} nesta causa.`))}handleStartSolve(){this.requireAuth(()=>{this.modalIcon.set("\u2692\uFE0F"),this.modalMessage.set("Miss\xE3o aceite! Envie o comprovativo ap\xF3s a resolu\xE7\xE3o.")})}handleCreateView(){this.requireAuth(()=>{this.uploadedPhotos.set([]),this.view.set("create")})}handleMockProfile(){this.requireAuth(()=>{this.modalIcon.set("\u{1F464}"),this.modalMessage.set(`${this.userName()}, tens ${this.userZelas()} Zelas.`)})}createReport(e){e.preventDefault(),this.requireAuth(()=>{if(this.userZelas()<10){this.modalIcon.set("\u26A0\uFE0F"),this.modalMessage.set("Saldo insuficiente (m\xEDnimo 10 Zelas).");return}this.userZelas.update(t=>t-10);let o=a(i({id:Math.random().toString(36).substr(2,9)},this.newReport),{status:"pendente",zelasAcumulados:10,apoios:0,photos:[...this.uploadedPhotos()],createdAt:new Date().toISOString(),userId:"current-user"});this.reports.update(t=>[o,...t]),this.newReport={title:"",description:"",category:"INFRAESTRUTURA",location:""},this.uploadedPhotos.set([]),this.view.set("list"),this.modalIcon.set("\u2705"),this.modalMessage.set("Den\xFAncia publicada!")})}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=u({type:r,selectors:[["app-root"]],decls:1,vars:0,template:function(o,t){o&1&&d(0,"router-outlet")},dependencies:[m,A,M,v],styles:[".animate-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .4s ease-out}.animate-slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .4s cubic-bezier(.16,1,.3,1)}.no-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.no-scrollbar[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(100%)}to{transform:translateY(0)}}"],changeDetection:0})};h(l,C).catch(r=>console.error(r));
